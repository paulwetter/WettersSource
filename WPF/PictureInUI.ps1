$xaml = @"
<Window xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" MinWidth="450"
   Width="575" SizeToContent="Height" Title="Picture In UI" Topmost="True">
   <StackPanel Grid.Row="0" Grid.Column="0" Margin="0,0,0,0" Orientation="Horizontal">
   <Image Width="136">
       <Image.Source>
           <BitmapImage DecodePixelWidth="136" UriSource="$FormLogoImage" />
       </Image.Source>
   </Image>
</StackPanel>
</Window>
"@


function Convert-XAMLtoWindow {
    param
    (
        [Parameter(Mandatory=$true)]
        [string]
        $XAML
    )
    
    Add-Type -AssemblyName PresentationFramework
    Add-Type -AssemblyName System.Windows.Forms
    
    $reader = [XML.XMLReader]::Create([IO.StringReader]$XAML)
    $result = [Windows.Markup.XAMLReader]::Load($reader)
    $reader.Close()
    $reader = [XML.XMLReader]::Create([IO.StringReader]$XAML)
    while ($reader.Read())
    {
        $name=$reader.GetAttribute('Name')
        if (!$name) { $name=$reader.GetAttribute('x:Name') }
        if($name)
        {$result | Add-Member NoteProperty -Name $name -Value $result.FindName($name) -Force}
    }
    $reader.Close()
    $result
}


function Show-WPFWindow {
    param
    (
        [Parameter(Mandatory)]
        [Windows.Window]
        $Window
    )
    
    $result = $null
    $null = $window.Dispatcher.InvokeAsync{
        $result = $window.ShowDialog()
        Set-Variable -Name result -Value $result -Scope 1
    }.Wait()
    $result
}


$LogoImage = "${Env:Temp}\VistaLogoUP.png"

$FormLogoImage = "${Env:Temp}\WSLogoSmall.png"
$FormLogoB64 = @'
iVBORw0KGgoAAAANSUhEUgAAAIgAAAAYCAYAAAAh3LURAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA25pVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQ4IDc5LjE2Mzg1OCwgMjAxOS8wMy8wNi0wMzoxODozNiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo3QjM1MEUxRjU4MENFOTExOTBBMEU4QzU4QkZBRkVENyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpFNjEyQjQxNTUwMDcxMUVDODdBOTk0MDMzRkU0NzBGRCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpFNjEyQjQxNDUwMDcxMUVDODdBOTk0MDMzRkU0NzBGRCIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgRWxlbWVudHMgMTEuMCBXaW5kb3dzIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6QzZFQTAxODE0RjUzMTFFQzhGQkZDOTQ3RTc5MEUyMEIiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6QzZFQTAxODI0RjUzMTFFQzhGQkZDOTQ3RTc5MEUyMEIiLz4gPC9yZGY6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
'@
[byte[]]$Bytes = [convert]::FromBase64String($FormLogoB64)
If (!(Test-Path $FormLogoImage)) {
    [System.IO.File]::WriteAllBytes($FormLogoImage,$Bytes)
}


$window = Convert-XAMLtoWindow -XAML $xaml
$null = Show-WPFWindow -Window $window
